if (self.CavalryLogger) { CavalryLogger.start_js(["q2KyZ"]); }

__d("P2PNUXRendererUtils",["CurrentUser","ImmutableObject","MercuryAttachmentType","P2PTransferParam","P2PTransferStatus","StoryAttachmentStyle"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={getTransferFromMessage:function(a){var c;if(!a||!a.attachments||!a.attachments.length)return null;a=a.attachments[0];this.isShareAttachment(a)&&(c=a.share.target);c&&(c=new(b("ImmutableObject"))(c));return c},isSuccessfulReceivedTransfer:function(a){return a&&a.receiver&&a.receiver.id===b("CurrentUser").getID()&&(a.status===b("P2PTransferStatus").COMPLETED||a.status===b("P2PTransferStatus").PENDING_RECIPIENT_NUX)},isShareAttachment:function(a){return!!(typeof a!=="string"&&a.attach_type==b("MercuryAttachmentType").SHARE&&a.share&&a.share.style_list&&a.share.style_list.indexOf(b("StoryAttachmentStyle").ORION)>=0)},doesNUXNeedCreditCards:function(a){var c=b("CurrentUser").getID()===a.sender.id;return!c&&a[b("P2PTransferParam").STATUS]===b("P2PTransferStatus").PENDING_RECIPIENT_NUX},isRecipientActionableStatus:function(a){var c=a[b("P2PTransferParam").STATUS];a=b("CurrentUser").getID()===a.sender.id;return!a&&(c===b("P2PTransferStatus").PENDING_RECIPIENT_NUX||c===b("P2PTransferStatus").PENDING_RECIPIENT_VERIFICATION||c===b("P2PTransferStatus").PENDING_PUSH_FAIL)}};e.exports=a}),null);
__d("P2PListRow.react",["cx","invariant","React"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;i=babelHelpers.inherits(a,b("React").Component);i&&i.prototype;a.prototype.render=function(){var a=this.props;b("React").Children.count(a.children)===2||h(0,1825);var c=a.offset,d=a.offsetRight!==void 0&&a.offsetRight+"px",e=a.offsetBottom!==void 0&&a.offsetBottom+"px";return b("React").createElement("div",{className:"_3q6c"+(c==="large"?" _3q6d":"")+(c==="small"?" _3q6o":"")},b("React").createElement("div",{className:"_3q6p",style:{paddingRight:d,paddingBottom:e}},a.children[0]),b("React").createElement("div",{className:"_3q6q",style:{paddingBottom:e}},a.children[1]))};function a(){i.apply(this,arguments)}a.propTypes={offset:c.oneOf(["large","small"]),offsetBottom:c.number,offsetRight:c.number};a.defaultProps={offset:"large"};e.exports=a}),null);
__d("P2PAddCreditCardDialog.react",["cx","fbt","CreditCardFormParam","Link.react","MessengerEnvironment","MessengerPaymentProductType","Middot.react","P2PAPI","P2PAPIUtils","P2PButton.react","P2PCreditCardForm.react","P2PCreditCardStore","P2PDialog.react","P2PDialogBody.react","P2PDialogFooter.react","P2PDialogTitle.react","P2PLinkConstants","P2PLoadingMask.react","P2PLogger","P2PPaymentConfig","P2PPaymentLoggerEvent","P2PText.react","React","emptyFunction"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j="fbP2PAddCreditCardDialog_learnMoreSentenceID";c=babelHelpers.inherits(a,b("React").Component);i=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={isValid:!1,formData:{},loading:!1,requestID:"",saveErrors:null,asyncRequestState:{}},this.onCreditCardStoreChange=function(){var a=b("P2PCreditCardStore").getAsyncRequestState(),c=a[this.state.requestID];this.setState({asyncRequestState:a});c&&(this.setState({requestID:""}),c.error?this.handleOnSaveError(c.error):this.handleOnSaveSuccess(c))}.bind(this),this.onSaveClick=function(){__p&&__p();var a=this.props.p2pPaymentConfig;if(!a){this.setState({loading:!1,saveErrors:{general:{message:h._("Cannot identify country.")}}});return}var c=b("P2PAPIUtils").genRequestID();this.setState(function(d){return{loading:!0,requestID:c,saveErrors:null,formData:babelHelpers["extends"]({},d.formData,(d={},d[b("CreditCardFormParam").COUNTRY]=a.countryCode,d))}},function(){b("P2PAPI").addCreditCard(babelHelpers["extends"]({requestID:c,product_type:this.props.productType},this.state.formData))}.bind(this));this.log(b("P2PPaymentLoggerEvent").UI_ACTN_CONFIRM_CARD_DETAILS)}.bind(this),this.handleValidation=function(a){this.setState(a)}.bind(this),this.onToggle=function(a){a||(this.props.onCancel(),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_CANCEL_ADD_CARD))}.bind(this),this.onCancelClicked=function(){this.onToggle(!1)}.bind(this),c}a.prototype.componentDidMount=function(){this.log(b("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_ADD_CARD),this.creditCardStoreSub=b("P2PCreditCardStore").addListener("change",this.onCreditCardStoreChange)};a.prototype.componentWillUnmount=function(){this.creditCardStoreSub&&(this.creditCardStoreSub.remove(),this.creditCardStoreSub=null)};a.prototype.log=function(a,c){b("P2PLogger").log(a,babelHelpers["extends"]({www_event_flow:this.props.eventFlow,object_id:this.props.loggingObjectID},this.props.loggingData,c))};a.prototype.handleOnSaveSuccess=function(a){this.props.onSuccess(a),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_ADD_CARD_SUCCESS)};a.prototype.handleOnSaveError=function(a){this.setState({loading:!1,saveErrors:a}),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_ADD_CARD_FAIL,{message:a&&a.general?a.general.message:""})};a.prototype.isSaveButtonDisabled=function(){return this.state.loading||!this.state.isValid};a.prototype.renderAddCardForm=function(){var a=this.props.p2pPaymentConfig;if(!a)return null;var c,d=this.props.title;this.props.showCancelButton&&(c=b("React").createElement(b("P2PButton.react"),{use:"default",size:"medium",label:this.props.cancelButtonText,disabled:this.state.loading,onClick:this.onCancelClicked}));return b("React").createElement("div",null,b("React").createElement(b("P2PDialogTitle.react"),null,d),b("React").createElement(b("P2PDialogBody.react"),null,b("React").createElement(b("P2PText.react"),{type:"primary",className:"_3-96"},this.props.text),b("React").createElement(b("P2PCreditCardForm.react"),{asyncRequestState:this.state.asyncRequestState,compactMode:!0,onValidation:this.handleValidation,postalRegex:a.postalRegex,productType:this.props.productType,saveErrors:this.state.saveErrors,showIcons:!1,showLabels:!0,showPlaceholderOnFocus:!0,showSecondaryIcons:!0,useGutters:!0}),b("React").createElement(b("P2PText.react"),{className:"_3-8y",id:j,type:"secondary"},h._("Your payment info is stored securely."),b("React").createElement("div",null,b("React").createElement(b("Link.react"),{"aria-describedby":j,href:b("P2PLinkConstants").addDebitCardHelpURI,target:"_blank"},h._("Learn More")),b("React").createElement(b("Middot.react"),null),b("React").createElement(b("Link.react"),{"aria-describedby":j,href:b("P2PLinkConstants").paymentsTermsURI,target:"_blank"},h._("Terms"))))),b("React").createElement(b("P2PDialogFooter.react"),{leftContent:this.props.leftContent},c,b("React").createElement(b("P2PButton.react"),{use:"confirm",size:"medium",label:this.props.saveButtonText,disabled:this.isSaveButtonDisabled(),onClick:this.onSaveClick})))};a.prototype.render=function(){return!this.props.p2pPaymentConfig?null:b("React").createElement(b("P2PDialog.react"),{behaviors:this.props.behaviors,layerHideOnBlur:!1,ref:"dialog",onToggle:this.onToggle,repositionOnUpdate:!0,shown:!0,width:this.props.width},this.renderAddCardForm(),b("React").createElement(b("P2PLoadingMask.react"),{visible:this.state.loading}))};a.defaultProps={cancelButtonText:h._("Cancel"),loggingData:{},onCancel:b("emptyFunction"),onSuccess:b("emptyFunction"),p2pPaymentConfig:b("P2PPaymentConfig").config,productType:b("MessengerPaymentProductType").P2P,saveButtonText:h._("Save"),showCancelButton:!0,text:h._("Please enter a Visa or MasterCard debit card. Credit cards can't be used."),title:h._("Add Debit Card"),width:b("MessengerEnvironment").messengerui?480:430};e.exports=a}),null);
__d("P2PConfirmAmountDialog.react",["fbt","MessengerEnvironment","P2PButton.react","P2PDialog.react","P2PDialogBody.react","P2PDialogFooter.react","P2PDialogTitle.react","P2PLoadingMask.react","P2PText.react","React","emptyFunction"],(function(a,b,c,d,e,f,g){__p&&__p();var h;c=b("React").PropTypes;var i=b("MessengerEnvironment").messengerui;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.state={loading:!1},this.handleCancelClick=function(){this.props.onCancel()}.bind(this),this.handleConfirmClick=function(){this.setState({loading:!0}),this.props.onConfirm()}.bind(this),this.getFormattedAmount=function(){return this.props.currencySymbol+""+this.props.amount}.bind(this),b}a.prototype.render=function(){"use strict";var a=i?350:300;return b("React").createElement(b("P2PDialog.react"),{behaviors:this.props.behaviors,layerHideOnBlur:!1,shown:!0,width:a},b("React").createElement(b("P2PDialogTitle.react"),{showCloseButton:!1},g._("Confirm Payment")),b("React").createElement(b("P2PDialogBody.react"),null,b("React").createElement(b("P2PText.react"),{type:"primary"},g._("Do you want to pay {recipient name} {amount}?",[g._param("recipient name",this.props.receiverName),g._param("amount",this.getFormattedAmount())]))),b("React").createElement(b("P2PDialogFooter.react"),null,b("React").createElement(b("P2PButton.react"),{label:g._("Cancel"),onClick:this.handleCancelClick,use:"default"}),b("React").createElement(b("P2PButton.react"),{label:g._("Pay"),onClick:this.handleConfirmClick,use:"confirm"})),b("React").createElement(b("P2PLoadingMask.react"),{visible:this.state.loading}))};a.propTypes={amount:c.string,currencySymbol:c.string,onCancel:c.func,onConfirm:c.func,receiverName:c.string};a.defaultProps={amount:"",currencySymbol:"",onCancel:b("emptyFunction"),onConfirm:b("emptyFunction"),receiverName:c.string};e.exports=a}),null);
__d("P2PGroupSendContactListItem.react",["cx","fbt","ix","Image.react","Link.react","MessengerContactImageReact.bs","React"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k=b("MessengerContactImageReact.bs").jsComponent,l=32;j=babelHelpers.inherits(a,b("React").PureComponent);j&&j.prototype;a.prototype.$1=function(a){return!a?null:b("React").createElement("div",{className:"_1jwz"},b("React").createElement(b("Image.react"),{src:i("86852")}))};a.prototype.$2=function(a){return!this.props.isDisabled?null:b("React").createElement("div",{className:"_1jw-"},h._("Isn't able to receive money right now"))};a.prototype.render=function(){var a=this.props,c=a.isSelected,d=a.participant;return b("React").createElement(b("Link.react"),{"aria-checked":c,className:"_1jw_",onClick:a.onClick,role:"checkbox"},b("React").createElement(k,{className:"_1jx2",isMessengerUser:d.is_messenger_user,size:l,src:d.image_src}),b("React").createElement("div",{className:"_1jx4"},b("React").createElement("div",{className:"_1jx5"},b("React").createElement("div",{className:"_1jx6"},d.name),this.$2(d)),this.$1(c)))};function a(){j.apply(this,arguments)}e.exports=a}),null);
__d("P2PGroupSendDialog.react",["cx","fbt","Image.react","MessengerContextualDialog.react","MessengerEnvironment","P2PActions","P2PLogger","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PText.react","React","ScrollableArea.react","XUIContextualDialog.react","immutable"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();a=b("React").PropTypes;c=b("React").createClass({displayName:"P2PGroupSendDialog",propTypes:{amount:a.string,currency:a.string,flyoutAlignment:a.oneOf(["left","center","right"]),fromChatTab:a.bool,onToggle:a.func.isRequired,openRequestTab:a.bool,p2pEligibilities:a.object,participants:a.instanceOf(b("immutable").List),referrer:a.string,threadID:a.string.isRequired,threadFBID:a.string.isRequired},componentDidMount:function(){this.props.amount?this.log(b("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_GROUP_SEND_TRIGGER,{raw_amount:this.props.amount,currency:this.props.currency}):this.log(b("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_GROUP_SEND)},log:function(a,c){b("P2PLogger").log(a,babelHelpers["extends"]({www_event_flow:b("P2PPaymentLoggerEventFlow").UI_FLOW_P2P_GROUP_SEND},c))},_handleToggle:function(a){this.props.onToggle(a),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_GROUP_SEND_CANCELLED)},_handleBlur:function(){this._handleToggle(!1)},isP2PIneligible:function(a){var b=this.props.p2pEligibilities;return b?b[a.userID]===!1:!0},renderParticipantRow:function(a){var c=b("MessengerEnvironment").messengerui;c=c?32:40;var d=this.isP2PIneligible(a),e;d&&(e=b("React").createElement(b("P2PText.react"),{className:"_4cof",type:"primary"},h._("Isn't able to receive money right now")));return b("React").createElement("li",{className:"_4cog"+(d?" _4coh":""),key:a.id,onClick:this.handleGroupThreadClicked.bind(this,a)},b("React").createElement("div",{className:"_4coi"},b("React").createElement(b("Image.react"),{className:"_4coj",height:c,src:a.big_image_src||a.image_src,width:c})),b("React").createElement("div",{className:"_4cok"},b("React").createElement(b("P2PText.react"),{className:"_4col",type:"primary"},a.name),e))},renderGroupList:function(){return b("React").createElement(b("ScrollableArea.react"),{height:178},b("React").createElement("ul",null,this.props.participants?this.props.participants.map(this.renderParticipantRow):null))},handleGroupThreadClicked:function(a){if(this.isP2PIneligible(a))return;this.props.onToggle(!1);b("P2PActions").chatSendViewOpened({amount:this.props.amount,openRequestTab:this.props.openRequestTab,referrer:this.props.referrer,threadID:this.props.threadID,groupSendRecipientUserIDs:[a.userID],groupThreadFBID:this.props.threadFBID,fromChatTab:this.props.fromChatTab});this.log(b("P2PPaymentLoggerEvent").UI_ACTN_GROUP_SEND_RECIPIENT_PICKED,{raw_amount:this.props.amount,currency:this.props.currency,object_id:a.userID})},render:function(){var a=b("MessengerEnvironment").messengerui,c=a?b("MessengerContextualDialog.react"):b("XUIContextualDialog.react"),d=a?302:280;return b("React").createElement(c,{alignment:this.props.flyoutAlignment?this.props.flyoutAlignment:a?"right":"left",context:this.props.context,onBlur:this._handleBlur,onToggle:this._handleToggle,shown:!0,width:d,position:"above"},b("React").createElement("div",{className:"_4com"+(a?" _4con":"")},b("React").createElement(b("P2PText.react"),{className:"_4coo",type:"primary",weight:"bold"},h._("Select a person")),this.renderGroupList()))}});e.exports=c}),null);
__d("P2PGroupSendParticipantsPickerDialog.react",["cx","fbt","LeftRight.react","MessengerContextualDialog.react","MessengerDialogButton.react","MessengerEnvironment","P2PActions","P2PGroupSendContactListItem.react","P2PLogger","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PText.react","React","ScrollableArea.react","XUIContextualDialog.react","immutable"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=5,k=5;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(a){__p&&__p();i.constructor.call(this,a);this.isMessengerDotCom=b("MessengerEnvironment").messengerui;this.$8=function(){this.$9(!1)}.bind(this);this.$10=function(){var a=this.$5().map(function(a){return a.fbid});this.props.onToggle(!1);if(a.length===0)return;b("P2PActions").chatSendViewOpened({amount:this.props.amount,openRequestTab:this.props.openRequestTab,referrer:this.props.referrer,threadID:this.props.threadID,groupSendRecipientUserIDs:a,groupThreadFBID:this.props.threadFBID,fromChatTab:this.props.fromChatTab});this.$3(b("P2PPaymentLoggerEvent").UI_ACTN_GROUP_SEND_RECIPIENT_PICKED,{raw_amount:this.props.amount,currency:this.props.currency,object_ids:a})}.bind(this);this.$9=function(a){this.props.onToggle(a),this.$3(b("P2PPaymentLoggerEvent").UI_ACTN_GROUP_SEND_CANCELLED)}.bind(this);this.$13=function(a){var c=a.fbid;return b("React").createElement(b("P2PGroupSendContactListItem.react"),{isDisabled:!this.$7(c),isSelected:this.$6(c),key:a.id,onClick:function(){return this.$11(c)}.bind(this),participant:a})}.bind(this);var c=a.participants.sort(this.$1),d=c.size>k;a=this.$2(c,a.p2pEligibilities);this.state={isParticipantChecked:d||a.size>0,participants:c.toArray(),isParticipantSelected:a}}a.prototype.componentDidMount=function(){this.props.amount?this.$3(b("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_GROUP_SEND_TRIGGER,{raw_amount:this.props.amount,currency:this.props.currency}):this.$3(b("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_GROUP_SEND)};a.prototype.UNSAFE_componentWillReceiveProps=function(a){if(!this.state.isParticipantChecked){a=this.$2(a.participants,a.p2pEligibilities);this.setState({isParticipantChecked:a.size>0,isParticipantSelected:a})}};a.prototype.$4=function(){return this.state.isMessengerDotCom?b("MessengerContextualDialog.react"):b("XUIContextualDialog.react")};a.prototype.$5=function(){return this.state.participants.filter(function(a){return this.$6(a.fbid)}.bind(this))};a.prototype.$7=function(a,b){if(!a)return!1;b=b||this.props.p2pEligibilities||{};return!!b[a]};a.prototype.$6=function(a){return!a?!1:!!this.state.isParticipantSelected.get(a)};a.prototype.$3=function(a,c){b("P2PLogger").log(a,babelHelpers["extends"]({www_event_flow:b("P2PPaymentLoggerEventFlow").UI_FLOW_P2P_GROUP_SEND},c))};a.prototype.$11=function(a){if(!a||!this.$7(a))return;var b=this.state.isParticipantSelected,c=this.$6(a);this.setState({isParticipantSelected:b.set(a,!c)})};a.prototype.$1=function(a,b){return a.name.localeCompare(b.name)};a.prototype.$2=function(a,c){if(a.size>k)return b("immutable").Map();var d=b("immutable").Map().withMutations(function(b){a.forEach(function(a){a=a.fbid;a&&this.$7(a,c)&&b.set(a,!0)}.bind(this))}.bind(this));return d};a.prototype.$12=function(){return this.state.participants.length<=j?b("React").createElement("ul",{className:"_3jwq"},this.state.participants.map(this.$13)):b("React").createElement(b("ScrollableArea.react"),{height:278},b("React").createElement("ul",null,this.state.participants.map(this.$13)))};a.prototype.$14=function(){var a=this.$5();return b("React").createElement(b("LeftRight.react"),{className:"_4coo"},b("React").createElement(b("P2PText.react"),{tabIndex:0,type:"primary",weight:"bold"},h._("Select People")),b("React").createElement(b("MessengerDialogButton.react"),{className:"_3jwt",disabled:a.length===0,label:h._("Continue"),onClick:this.$10,type:"primary"}))};a.prototype.render=function(){var a=this.$4(),c=this.isMessengerDotCom?"right":"left",d=this.isMessengerDotCom?302:280;return b("React").createElement(a,{alignment:this.props.flyoutAlignment||c,className:"_4com"+(this.isMessengerDotCom?" _4con":""),context:this.props.context,position:"above",shown:!0,type:"default",width:d,onBlur:this.$8,onToggle:this.$9},this.$14(),this.$12())};e.exports=a}),null);
__d("P2PMemoPhotoUploadPreview.react",["cx","BackgroundImage.react","MessengerEnvironment","P2PLoadingMask.react","React","XUICloseButton.react"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.renderAttachedPhotoPreviewContent=function(){var a=this.props.attachedPhoto;if(!a||!a.url)return null;var c=b("MessengerEnvironment").messengerui?286:260;return b("React").createElement(b("BackgroundImage.react"),{backgroundSize:"cover",height:120,src:a.url,width:c})}.bind(this),c}a.prototype.render=function(){var a=this.props.attachedPhoto;return!this.props.photoUploading&&!a?null:b("React").createElement("div",{className:"_y37"},this.renderAttachedPhotoPreviewContent(),b("React").createElement(b("P2PLoadingMask.react"),{visible:this.props.photoUploading}),b("React").createElement(b("XUICloseButton.react"),{className:"_y38",onClick:this.props.onRemoveButtonClick,shade:"light",size:"medium"}))};a.propTypes={attachedPhoto:c.object,photoUploading:c.bool,onRemoveButtonClick:c.func};e.exports=a}),null);
__d("P2PMemoPhotoUploadSelector.react",["cx","fbt","FileInput","FileInputUploader","React","ReactDOM"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;var j="/ajax/payments/p2p/memo_photo_upload/",k=1,l=29;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.fileInput=null,this.$1=null,this.handleFileInputChange=function(){if(this.fileInput&&this.fileInput.getValue()){var a=new(b("FileInputUploader"))(this.fileInput.getInput()).setAllowCrossPageTransition(!0).setURI(j);a.subscribe(["success","failure"],function(a,b){this.props.onPhotoUploadComplete(b.response)}.bind(this));a.setData({profile_id:k,source:l}).send();this.props.onPhotoUploadStart()}}.bind(this),c}a.prototype.componentDidMount=function(){var a=b("ReactDOM").findDOMNode(this.refs.PhotoInputContainer),c=b("ReactDOM").findDOMNode(this.refs.PhotoInputControl),d=b("ReactDOM").findDOMNode(this.refs.PhotoInput);this.fileInput=new(b("FileInput"))(a,c,d);this.$1=this.fileInput.subscribe("change",this.handleFileInputChange)};a.prototype.componentWillUnmount=function(){this.$1&&this.$1.unsubscribe()};a.prototype.render=function(){var a=h._("Add Photo");return b("React").createElement("div",{"aria-label":a,className:"_m _3h1u"+(this.props.photoUploading||this.props.attachedPhoto?" _3h1v":""),ref:"PhotoInputContainer"},b("React").createElement("i",{className:"_3h1w",ref:"PhotoInputControl"},b("React").createElement("input",{accept:"image/*",className:"_n",name:"file",ref:"PhotoInput",title:a,type:"file"})))};a.propTypes={attachedPhoto:c.object,isUploading:c.bool,onPhotoUploadComplete:c.func.isRequired,onPhotoUploadStart:c.func.isRequired};e.exports=a}),null);
__d("P2PMemoField.react",["cx","fbt","ix","Image.react","MessengerEnvironment","P2PGKValues","P2PMemoPhotoUploadPreview.react","P2PMemoPhotoUploadSelector.react","React"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);j=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=j.constructor).call.apply(a,[this].concat(e)),this.state={attachedPhoto:null,defaultValue:"",disabled:!1,focused:!1,isRequesting:!1,photoUploading:!1},this.handleChangeText=function(a){this.props.onTextChange(a.target.value)}.bind(this),this.handleImageClick=function(){this.refs.input.focus()}.bind(this),this.handleFocus=function(){this.setState({focused:!0})}.bind(this),this.handleBlur=function(){this.setState({focused:!1})}.bind(this),this.handlePhotoUploadStart=function(){this.setState({photoUploading:!0}),this.props.onPhotoUploadingChange(!0)}.bind(this),this.handlePhotoUploadComplete=function(a){a=a.payload||null;this.setState({attachedPhoto:a,photoUploading:!1});this.props.onPhotoChange(a?[a.fbid]:[]);this.props.onPhotoUploadingChange(!1)}.bind(this),this.handlePhotoRemove=function(){this.setState({attachedPhoto:null,photoUploading:!1}),this.props.onPhotoChange([]),this.props.onPhotoUploadingChange(!1)}.bind(this),this.getImageSrc=function(){var a=b("MessengerEnvironment").messengerui;if(this.state.focused)if(a)return i("94382");else return i("94384");else if(a)return i("94383");else return i("94385")}.bind(this),this.getPlaceholder=function(){return this.props.isRequesting?h._("What is this request for?"):h._("What is this payment for?")}.bind(this),this.shouldRenderPhotoMemo=function(){return b("P2PGKValues").P2PWWWMemoPhotoEnabled&&!this.props.isRequesting}.bind(this),this.renderPhotoUploadSelector=function(){return!this.shouldRenderPhotoMemo()?null:b("React").createElement("div",{className:"_1-j-"},b("React").createElement(b("P2PMemoPhotoUploadSelector.react"),{attachedPhoto:this.state.attachedPhoto,photoUploading:this.state.photoUploading,onPhotoUploadComplete:this.handlePhotoUploadComplete,onPhotoUploadStart:this.handlePhotoUploadStart}))}.bind(this),this.renderPhotoUploadPreview=function(){return!this.shouldRenderPhotoMemo()?null:b("React").createElement(b("P2PMemoPhotoUploadPreview.react"),{attachedPhoto:this.state.attachedPhoto,photoUploading:this.state.photoUploading,onRemoveButtonClick:this.handlePhotoRemove})}.bind(this),c}a.prototype.render=function(){return b("React").createElement("div",{className:"_2z8p"},b("React").createElement("div",{className:"_1-j_"},b("React").createElement(b("Image.react"),{className:"_2z8q",height:12,onClick:this.handleImageClick,src:this.getImageSrc(),width:12}),b("React").createElement("input",{className:"_2z8r",defaultValue:this.props.defaultValue,disabled:this.props.disabled,maxLength:36,onChange:this.handleChangeText,onBlur:this.handleBlur,onFocus:this.handleFocus,placeholder:this.getPlaceholder(),ref:"input"}),this.renderPhotoUploadSelector()),this.renderPhotoUploadPreview())};a.propTypes={defaultValue:c.string,disabled:c.bool,isRequesting:c.bool,onTextChange:c.func.isRequired,onPhotoChange:c.func.isRequired,onPhotoUploadingChange:c.func.isRequired};e.exports=a}),null);
__d("P2PMemoText.react",["cx","fbt","P2PText.react","React"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;i=babelHelpers.inherits(a,b("React").Component);i&&i.prototype;a.prototype.render=function(){return b("React").createElement("div",{className:"_4myt"},b("React").createElement(b("P2PText.react"),{display:"inline",type:"primary",weight:"bold"},h._("For: {Memo description}",[h._param("Memo description",b("React").createElement(b("P2PText.react"),{display:"inline",type:"secondary",weight:"normal"},this.props.memoText))])))};function a(){i.apply(this,arguments)}a.propTypes={memoText:c.string.isRequired};e.exports=a}),null);
__d("intlAmountInputUtils",["NumberFormatConfig"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){a===void 0&&(a=!0),this.trailingDecimalSeparator=!1,this.trailingZeros=[!1,!1],this.allowDecimals=a}a.prototype.parseAmount=function(a){__p&&__p();a=a.split(b("NumberFormatConfig").decimalSeparator);var c=a[0];a=a[1];this.trailingZeros=[!1,!1];a&&(a=a.substr(0,2),this.trailingZeros[0]=a[0]==="0",this.trailingZeros[1]=a[1]==="0");a===""?this.trailingDecimalSeparator=!0:this.trailingDecimalSeparator=!1;if(c&&!a)return parseFloat(c);else if(!c&&a)return parseFloat("0."+a);else if(c&&a)return parseFloat(c+"."+a);else return NaN};a.prototype.formatAmount=function(a){__p&&__p();if(Number.isNaN(a))return"";a=a.toString();a=a.split(".");var c=a[0];a=a[1];var d="";for(var e=c.length-1;e>=0;e--){d+=c[e];var f=c.length-e;f!==c.length&&f%(b("NumberFormatConfig").minDigitsForThousandsSeparator-1)===0&&(d+=b("NumberFormatConfig").numberDelimiter)}d=d.split("").reverse().join("");f=d;a?(f+=b("NumberFormatConfig").decimalSeparator+a,this.trailingZeros[1]&&(f+="0")):this.trailingZeros[0]?(f+=b("NumberFormatConfig").decimalSeparator+"0",this.trailingZeros[1]&&(f+="0")):this.trailingDecimalSeparator&&(f+=b("NumberFormatConfig").decimalSeparator);return f};a.prototype.formatAsDisplayAmount=function(a){var c=a.split(b("NumberFormatConfig").decimalSeparator)[1];if(c){if(c.length===1)return a+"0"}else if(c==="")return a.slice(0,a.length-1);return a};a.prototype.sanitizeAmount=function(a){var c;this.allowDecimals?c=new RegExp("[^\\d\\"+b("NumberFormatConfig").decimalSeparator+"]+","g"):c=new RegExp("[^\\d]+","g");return a.replace(c,"")};e.exports=new a()}),null);
__d("P2PSendMoneyAmountInput.react",["cx","fbt","Middot.react","NumberFormatConfig","React","XUIError.react","XUIGrayText.react","emptyFunction","intlAmountInputUtils"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;var j=200,k=32,l=1,m=Object.freeze({LEFT:37,RIGHT:39,DELETE:8,ZERO:48,NINE:57,NUMPADZERO:96,NUMPADNINE:105}),n=h._("Please enter a smaller amount"),o,p;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(a){__p&&__p();i.constructor.call(this,a),this.$1=!1,this.focus=function(){var a,b=this.state.value;this.$1&&this.refs.textInput&&(a=this.refs.textInput,a.focus(),b?b=b.length:b=0,a.setSelectionRange(b,b))}.bind(this),this.handleCaretMoveOnMouseUp=function(a){a=this.refs.textInput;if(!a)return;if(typeof a.selectionStart==="number"&&typeof a.selectionEnd==="number"){var c=a.selectionStart,d=a.selectionEnd;this.state.value[c-1]===b("NumberFormatConfig").numberDelimiter&&c--;this.state.value[d-1]===b("NumberFormatConfig").numberDelimiter&&d--;a.setSelectionRange(c,d)}}.bind(this),this.handleCaretMoveOnKeyDown=function(a){__p&&__p();p=!1;var c=this.refs.textInput;if(!c)return;if(typeof c.selectionStart==="number"&&typeof c.selectionEnd==="number"){var d=c.selectionStart,e=c.selectionEnd;if(a.keyCode===m.LEFT)this.state.value[d-2]===b("NumberFormatConfig").numberDelimiter&&(a.preventDefault(),d===e?c.setSelectionRange(d-2,d-2):c.setSelectionRange(d-2,e));else if(a.keyCode===m.RIGHT)this.state.value[d]===b("NumberFormatConfig").numberDelimiter&&(a.preventDefault(),d===e?c.setSelectionRange(e+2,e+2):c.setSelectionRange(d,e+2));else if(a.keyCode===m.DELETE){p=!0;c=this.state.value.split(b("NumberFormatConfig").decimalSeparator);e=c[0];c=c[1];this.state.value[d-1]===b("NumberFormatConfig").decimalSeparator&&e.length%b("NumberFormatConfig").minDigitsForThousandsSeparator+c.length>=4?o=d:e.length>1&&d<=e.length&&e.length%b("NumberFormatConfig").minDigitsForThousandsSeparator===1?o=d-2:o=d-1}else if(a.keyCode>=m.ZERO&&a.keyCode<=m.NINE||a.keyCode>=m.NUMPADZERO&&a.keyCode<=m.NUMPADNINE){p=!0;c=this.state.value.split(b("NumberFormatConfig").decimalSeparator);e=c[0];(e.length+1)%b("NumberFormatConfig").minDigitsForThousandsSeparator===0?o=d+2:o=d+1}}}.bind(this),this.handleAmountInputChange=function(a){this.processAmount(a.target.value)}.bind(this),this.handleAmountInputBlur=function(a){a=a.target.value;var c=b("intlAmountInputUtils").formatAsDisplayAmount(a);c!==a&&this.setState({value:c},this.updateWidth)}.bind(this),this.updateWidth=function(){var a=this.getMockWidth();a&&this.setState(function(b){return{width:Math.min(a,b.maxInputWidth)}})}.bind(this),this.state={inputError:null,maxInputWidth:j,value:a.value,width:this.getMockWidth()},b("intlAmountInputUtils").allowDecimals=this.props.allowDecimals}a.prototype.componentDidMount=function(){this.$1=!0,this.processAmount(this.state.value),this.props.disabled||this.initDelayedFocus()};a.prototype.componentWillUnmount=function(){this.$1=!1};a.prototype.componentDidUpdate=function(a,b){p&&(this.refs.textInput.setSelectionRange(o,o),p=!1)};a.prototype.initDelayedFocus=function(){setTimeout(this.focus)};a.prototype.processAmount=function(a){a=b("intlAmountInputUtils").sanitizeAmount(a);a===b("NumberFormatConfig").decimalSeparator&&(a="0"+a);a=b("intlAmountInputUtils").parseAmount(a);var c=a<=this.props.maxAmount&&!Number.isNaN(a)&&a>0,d=Number.isNaN(a)||a<=this.props.maxAmount;this.props.onInputChange(Number.isNaN(a)?"":b("intlAmountInputUtils").formatAsDisplayAmount(a.toString()),c);c=b("intlAmountInputUtils").formatAmount(a);d?this.setState({value:c,inputError:null},this.updateWidth):this.setState({value:c,inputError:n},this.updateWidth)};a.prototype.getMockWidth=function(){var a=this.refs.mock_input;if(a)if(a.offsetWidth===0)return k;else return a.offsetWidth+l;else return 0};a.prototype.renderGroupRequestInformation=function(){if(this.props.receiversCount<=1)return null;var a=this.props.amountOffset;parseFloat(this.props.value)?a=Math.round(parseFloat(this.props.value)*this.props.receiversCount*a)/a:a=0;return b("React").createElement(b("XUIGrayText.react"),{display:"block",size:"meta1"},h._("Per Person"),b("React").createElement(b("Middot.react"),null),h._("{currency}{total} Total",[h._param("currency",this.props.currencySymbol),h._param("total",a)]))};a.prototype.render=function(){var a,c=!this.state.value.length;c&&(a=b("React").createElement("div",{ref:"placeholder_input",className:"_1-sv"},"0"));return b("React").createElement("div",{className:"_ipw"+(this.props.isRequesting?" _1c9h":"")},b("React").createElement("label",null,b("React").createElement("div",{className:"_4puh"+(c?" _1-sy":"")},a,b("React").createElement("div",{ref:"mock_input",className:"_5fbs"},this.state.value),b("React").createElement(b("XUIError.react"),{xuiError:this.state.inputError},b("React").createElement("span",{className:"_1-sz","data-currency-symbol":this.props.currencySymbol},b("React").createElement("input",{autoFocus:!0,className:"_5fbv",disabled:this.props.disabled,onBlur:this.handleAmountInputBlur,onChange:this.handleAmountInputChange,onKeyDown:this.handleCaretMoveOnKeyDown,onMouseUp:this.handleCaretMoveOnMouseUp,ref:"textInput",style:{width:this.state.width},value:this.state.value}))),this.renderGroupRequestInformation())))};a.propTypes={allowDecimals:c.bool.isRequired,amountOffset:c.number.isRequired,currencySymbol:c.string,disabled:c.bool,isRequesting:c.bool,maxAmount:c.number.isRequired,onInputChange:c.func.isRequired,receiversCount:c.number,value:c.string};a.defaultProps={currencySymbol:"$",disabled:!1,isRequesting:!1,maxAmount:9999.99,onInputChange:b("emptyFunction"),receiversCount:1,value:""};e.exports=a}),null);
__d("P2PPaymentPhasesQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";__p&&__p();e.exports=function(){__p&&__p();var a;a=babelHelpers.inherits(c,b("WebGraphQLQueryBase"));a&&a.prototype;c.__getDocID=function(){"use strict";return"1864738660245468"};c.getQueryID=function(){"use strict";return"346225005861160"};function c(){"use strict";a.apply(this,arguments)}return c}()}),null);
__d("P2PPaymentSupportedCountry",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({US:"US",PE:"PE",PH:"PH",FR:"FR",GB:"GB",TH:"TH",VN:"VN",FB:"FB"})}),null);
__d("P2PSendMoneyDialogActionHeader.react",["cx","fbt","React","ShimButton.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;i=babelHelpers.inherits(a,b("React").Component);i&&i.prototype;a.prototype.renderPayTab=function(){if(this.props.isPayTabDisabled)return null;var a=this.props.isPaying;return b("React").createElement(b("ShimButton.react"),{className:"_50cx"+(a?" _50cy":""),onClick:this.props.onPayClick},h._("Pay"))};a.prototype.renderRequestTab=function(){if(this.props.isRequestTabDisabled)return null;var a=this.props.isRequesting;return b("React").createElement(b("ShimButton.react"),{className:"_50cx"+(a?" _50cy":""),onClick:this.props.onRequestClick},h._("Request"))};a.prototype.render=function(){var a=!!this.props.isPayTabDisabled,c=!!this.props.isRequestTabDisabled;return b("React").createElement("div",{className:"_50cr"+(a||c?" _3b-h":"")+(this.props.isPaying?" _50cv":"")+(this.props.isRequesting?" _50cw":"")},this.renderPayTab(),this.renderRequestTab(),b("React").createElement("div",{className:"_50c_"}))};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("P2PGatingFailReason",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({NON_PERSONAL_USER:"non_personal_user",IS_WORK_USER:"is_work_user",P2P_ENABLED_GK_FAIL:"p2p_enabled_gk_fail",P2P_ELIGIBLE_GK_FAIL:"p2p_eligible_gk_fail",SENDER_AND_RECEIVER_DIFFERENT_PRIMARY_PRODUCT:"sender_and_receiver_different_primary_product",HAS_NOT_RECEIVED_MONEY:"has_not_received_money",PAYMENT_ACCOUNT_DISABLED:"payment_account_disabled",MBASIC:"mbasic",IS_MESSENGER_ONLY_ACCOUNT:"is_messenger_only_account",IS_MOMENTS_ONLY_ACCOUNT:"is_moments_only_account",IS_PARTIES_ONLY_ACCOUNT:"is_parties_only_account",EXCEPTION:"exception",APP_CAPABILITY:"app_capability",USER_BLOCKED:"user_blocked",MESSAGES_BLOCKED:"messages_blocked",SVA_RECEIVER_GATING:"sva_receiver_gating",UNDER_AGE:"under_age",NO_ELIGIBLE_SVA:"no_eligible_sva",SENDER_AND_RECEIVER_ARE_SAME_USER:"sender_and_receiver_are_same_user",SENDER_PAYMENT_SETTING_IDV_PENDING:"sender_payment_setting_idv_pending",RECEIVER_PAYMENT_SETTING_IDV_PENDING:"receiver_payment_setting_idv_pending",SENDER_CANNOT_MESSAGE_RECEIVER:"sender_cannot_message_receiver",RECEIVER_CANNOT_MESSAGE_SENDER:"receiver_cannot_message_sender",MEMORIALIZED_USER:"memorialized_user",SANCTIONED_COUNTRY:"sanctioned_country"})}),null);
__d("PaymentSettingsStringUtils",["fbt","P2PGatingFailReason","P2PLinkConstants","React"],(function(a,b,c,d,e,f,g){"use strict";a={getPaymentsDPOText:function(){return g._("For your security, payments have been temporarily turned off. Please {=contact us} to learn more.",[g._param("=contact us",b("React").createElement("a",{href:b("P2PLinkConstants").disabledPaymentsSupportURI},"contact us"))])},getGeneralP2PDisabledText:function(){return g._("You are not able to use payments in messages right now. Please try again later.")},getP2PDisabledText:function(a){switch(a){case b("P2PGatingFailReason").PAYMENT_ACCOUNT_DISABLED:return this.getPaymentsDPOText();default:return this.getGeneralP2PDisabledText()}}};e.exports=a}),null);
__d("P2PSendMoneyDialog.react",["cx","fbt","Arbiter","CreditCardFormParam","Image.react","ImageBlock.react","Link.react","MessengerContactImage.react","MessengerContextualDialog.react","MessengerEnvironment","MessengerHorizontalScroll.react","P2PAddCreditCardDialog.react","P2PAPI","P2PBigAmount.react","P2PButton.react","P2PChooseCreditCardForm.react","P2PConfirmAmountDialog.react","P2PCreditCardStore","P2PDialog.react","P2PDialogTitle.react","P2PEditCreditCardDialog.react","P2PGKValues","P2PLinkConstants","P2PLoadingMask.react","P2PLogger","P2PMemoField.react","P2PMemoText.react","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PSendMoneyAmountInput.react","P2PSendMoneyDialogActionHeader.react","P2PText.react","P2PVerifyCreditCardDialog.react","PaymentSettingsStringUtils","PECurrency","React","ReactLayeredComponentMixin_DEPRECATED","XUIContextualDialog.react","XUISpinner.react","immutable"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();a=b("React").PropTypes;var i=b("MessengerEnvironment").messengerui,j=b("P2PGKValues").P2PRequestMoneyEnabled,k=h._("Change"),l=h._("Add Debit Card"),m=100;c=b("React").createClass({displayName:"P2PSendMoneyDialog",mixins:[b("ReactLayeredComponentMixin_DEPRECATED")],propTypes:{amount:a.string.isRequired,currency:a.string.isRequired,currencySymbol:a.string.isRequired,groupThreadFBID:a.string,flyoutAlignment:a.oneOf(["left","center","right"]),openRequestTab:a.bool,memoText:a.string,onError:a.func.isRequired,onPaymentRequestError:a.func.isRequired,onPaymentRequestSuccess:a.func.isRequired,onSendSuccess:a.func.isRequired,onToggle:a.func.isRequired,platformData:a.object,receivers:a.instanceOf(b("immutable").List).isRequired,referrer:a.string,paymentRequestID:a.string,position:a.oneOf(["above","below","left","right"]),p2pEligibilities:a.object,p2pPaymentConfig:a.shape({currencyCode:a.string.isRequired,enabledActions:a.object.isRequired,enabledPaymentMethods:a.object.isRequired,maxTransferAmount:a.number.isRequired,title:a.string,use_payment_module_method_picker:a.bool,countryCode:a.string.isRequired,postalRegex:a.string.isRequired}).isRequired,useModal:a.bool},getDefaultProps:function(){return{amount:"",openRequestTab:!1,receivers:b("immutable").List(),useModal:!1}},getInitialState:function(){var a=b("P2PCreditCardStore").getAll(),c=this.props.openRequestTab||this.isGroupRequest();return{asyncRequestState:b("P2PCreditCardStore").getAsyncRequestState(),addCreditCardDialogShown:!1,amount:this.props.amount,creditCardsFetchError:b("P2PCreditCardStore").failedCreditCardFetch(),creditCards:a,confirmAmountDialogShown:!1,isAmountValid:!!this.props.paymentRequestID,isCreditCardsFetchComplete:b("P2PCreditCardStore").isCreditCardsFetchComplete(),isMemoPhotoUploading:!1,isPaying:!c,isRequesting:c,loading:!1,memoText:this.props.memoText,memoPhotoIDs:[],selectedCard:a[0],showChooseCreditCardForm:!1,verifyCreditCardDialogShown:!1}},creditCardStoreSub:null,_isAmountVerified:!1,passwordCancelSubscribeToken:null,_isMounted:!1,getDialogWidth:function(){return this.props.useModal?i?380:312:i?286:260},getEventFlow:function(){return this.props.paymentRequestID||this.isRequesting()?b("P2PPaymentLoggerEventFlow").UI_FLOW_P2P_REQUEST:b("P2PPaymentLoggerEventFlow").UI_FLOW_P2P_SEND},getLogObjectIDs:function(){var a=this.props.receivers;if(a.size>1)return{object_ids:a.map(function(a){return a.userID}).join(",")};a=a.get(0)||{};return{object_id:a.userID}},log:function(a,c){var d=this.getLogObjectIDs();b("P2PLogger").log(a,babelHelpers["extends"]({www_event_flow:this.getEventFlow(),memo_text:this.state.memoText,request_id:this.props.paymentRequestID},this.getPlatformLoggingData(),c,this.getReferrer(),d))},componentDidMount:function(){this._isMounted=!0},componentWillUnmount:function(){this._isMounted=!1,this.passwordCancelSubscribeToken&&(b("Arbiter").unsubscribe(this.passwordCancelSubscribeToken),this.passwordCancelSubscribeToken=null),this.creditCardStoreSub&&(this.creditCardStoreSub.remove(),this.creditCardStoreSub=null)},UNSAFE_componentWillMount:function(){this.creditCardStoreSub=b("P2PCreditCardStore").addListener("change",this.onCreditCardStoreChange),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_SEND),b("P2PGKValues").P2PDisabledReason?this.log(b("P2PPaymentLoggerEvent").UI_ACTN_P2P_SENDER_DISABLED_SHOWN):this.isRecipientIneligible()&&this.log(b("P2PPaymentLoggerEvent").UI_ACTN_P2P_RECIPIENT_INELIGIBLE_SHOWN)},getPlatformLoggingData:function(){var a=this.props.platformData&&this.props.platformData.loggingData;return a?{platform_logging_data:a}:null},getReferrer:function(){var a=this.props.referrer;return a?{www_event_referrer:a}:null},onAmountInputChange:function(a,b){this.setState({amount:a,isAmountValid:b})},onCreditCardStoreChange:function(){var a=b("P2PCreditCardStore").getAll(),c;this.state.selectedCard&&(c=a.filter(function(a){return a.getCredentialId()===this.state.selectedCard.getCredentialId()}.bind(this))[0]);c||(c=a[0]);this.setState({asyncRequestState:b("P2PCreditCardStore").getAsyncRequestState(),creditCards:a,isCreditCardsFetchComplete:b("P2PCreditCardStore").isCreditCardsFetchComplete(),selectedCard:c,creditCardsFetchError:b("P2PCreditCardStore").failedCreditCardFetch()})},shouldShowConfirmAmountDialog:function(){var a=this.state.amount;a=a?a.replace(/\,/g,""):"";a=parseFloat(a);return!this._isAmountVerified&&a>=m},shouldShowVerifyCreditCardDialog:function(){return!this.state.selectedCard.getIsVerified()},shouldShowEditCreditCardDialog:function(){return this.state.selectedCard.isExpired()},handleSendClick:function(){if(this.isSendButtonDisabled())return;this.log(b("P2PPaymentLoggerEvent").UI_ACTN_SEND_CLICKED,{raw_amount:this.state.amount,currency:this.props.currency});this._isAmountVerified=!1;this.initiatePayment()},handleRequestClick:function(){if(this.isRequestButtonDisabled())return;this.log(b("P2PPaymentLoggerEvent").UI_ACTN_REQUEST_CLICKED,{raw_amount:this.state.amount,currency:this.props.currency});this.createPaymentRequest()},initiatePayment:function(){__p&&__p();if(this.shouldShowConfirmAmountDialog()){this.hideAllDialogs();this.setState({confirmAmountDialogShown:!0});this.log(b("P2PPaymentLoggerEvent").UI_ACTN_CONFIRM_AMOUNT,{raw_amount:this.state.amount,currency:this.props.currency});return}else if(this.shouldShowEditCreditCardDialog()){this.hideAllDialogs();this.setState({editCreditCardDialogShown:!0});this.log(b("P2PPaymentLoggerEvent").UI_ACTN_EDIT_CARD,{raw_amount:this.state.amount,currency:this.props.currency});return}else if(this.shouldShowVerifyCreditCardDialog()){this.hideAllDialogs();this.setState({verifyCreditCardDialogShown:!0});this.log(b("P2PPaymentLoggerEvent").UI_ACTN_VERIFY_CSC,{raw_amount:this.state.amount,currency:this.props.currency});return}this.createTransaction()},isGroupRequest:function(){return this.props.receivers.size>1},isPayingForRequest:function(){return!!this.props.paymentRequestID},isPaying:function(){return this.state.isPaying===!0},isRequesting:function(){return this.state.isRequesting===!0},shouldShowLoading:function(){return!this.state.addCreditCardDialogShown&&!this.state.confirmAmountDialogShown&&!this.state.verifyCreditCardDialogShown&&!this.state.editCreditCardDialogShown},createTransaction:function(){__p&&__p();var a={},c=this.props.receivers.get(0)||{};this.setState({loading:this.shouldShowLoading()});a[b("CreditCardFormParam").CREDENTIAL_ID]=this.state.selectedCard.getCredentialId();a.amount=this.state.amount;a.receiverId=c.userID;a.memoText=this.state.memoText;a.memoPhotoIDs=this.state.memoPhotoIDs;a.paymentRequestID=this.props.paymentRequestID;this.props.groupThreadFBID&&(a.group_thread_fbid=this.props.groupThreadFBID);this.props.platformData&&(a.platform_context_id=this.props.platformData.platformContextID);this.passwordCancelSubscribeToken=b("Arbiter").subscribeOnce("PasswordReauthDialogCancelClick",this.handlePasswordReauthDialogCancelClick);b("P2PAPI").createTransaction({formData:a,error:this.setCreateTransferError,success:this.setCreateTransferSuccess});this.log(b("P2PPaymentLoggerEvent").UI_ACTN_CONFIRM_SEND,{raw_amount:this.state.amount,currency:this.props.currency})},createPaymentRequest:function(){this.setState({loading:this.shouldShowLoading()});var a=this.props.platformData||{};b("P2PAPI").createPaymentRequest({formData:{amount:this.state.amount,memoText:this.state.memoText,group_thread_fbid:this.props.groupThreadFBID,requestees:this.props.receivers,platform_context_id:a.platformContextID},error:this.setCreatePaymentRequestError,success:this.setCreatePaymentRequestSuccess});this.log(b("P2PPaymentLoggerEvent").UI_ACTN_CONFIRM_REQUEST,{raw_amount:this.state.amount,currency:this.props.currency})},hideAllDialogs:function(){this.setState({addCreditCardDialogShown:!1,confirmAmountDialogShown:!1,verifyCreditCardDialogShown:!1,editCreditCardDialogShown:!1})},isDialogShowing:function(){return!!(this.state.addCreditCardDialogShown||this.state.confirmAmountDialogShown||this.state.verifyCreditCardDialogShown||this.state.editCreditCardDialogShown)},setCreateTransferError:function(a){this._isMounted&&(this.hideAllDialogs(),this.setState({loading:!1})),this.props.onError(a),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_SEND_FAIL)},setCreateTransferSuccess:function(a){this._isMounted&&(this.setState({loading:!1}),this.hideAllDialogs()),this.props.onSendSuccess(a),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_SEND_SUCCESS)},setCreatePaymentRequestError:function(a){this._isMounted&&(this.hideAllDialogs(),this.setState({loading:!1})),this.props.onPaymentRequestError(a.error),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_REQUEST_FAIL)},setCreatePaymentRequestSuccess:function(a){this._isMounted&&(this.setState({loading:!1}),this.hideAllDialogs()),this.props.onPaymentRequestSuccess(),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_REQUEST_SUCCESS,{request_id:a.id})},handlePasswordReauthDialogCancelClick:function(){this.passwordCancelSubscribeToken=null,this.setState({loading:!1}),this.hideAllDialogs()},onAddCreditCardCancel:function(){this.setState({addCreditCardDialogShown:!1})},onAddCreditCardSuccess:function(a){var c=b("P2PCreditCardStore").getAll();c=c.filter(function(c){c=c.getCredentialId();return a[b("CreditCardFormParam").CREDENTIAL_ID]===c})[0];this.setState({selectedCard:c},function(){this.state.isAmountValid?this.initiatePayment():(this.setState({addCreditCardDialogShown:!1}),this.focusAmountInput())}.bind(this))},onEditCreditCardSuccess:function(){this.initiatePayment()},onEditCreditCardCancel:function(){this.setState({editCreditCardDialogShown:!1})},focusAmountInput:function(){this.refs.send_money_amount_input&&this.refs.send_money_amount_input.focus()},_handleToggle:function(a){this.props.onToggle(a),this.state.loading||this.log(b("P2PPaymentLoggerEvent").UI_ACTN_SEND_MONEY_CANCELLED)},_handleBlur:function(){this._handleToggle(!1)},handleAddCreditCardClick:function(){this.setState({addCreditCardDialogShown:!0,showChooseCreditCardForm:!1}),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_CHANGE_CARD)},handleBackClick:function(){this.setState({showChooseCreditCardForm:!1},function(){this.focusAmountInput()}.bind(this))},handleChooseCardNextClick:function(){var a=this.refs.choose_credit_card_form.getSelectedCard();this.setState({selectedCard:a,showChooseCreditCardForm:!1},function(){this.focusAmountInput()}.bind(this))},handleAddCardNextClick:function(){this.setState({addCreditCardDialogShown:!0})},handleChangeSelectedCardClick:function(){var a={};this.state.creditCards.length===1?(a.addCreditCardDialogShown=!0,this.log(b("P2PPaymentLoggerEvent").UI_ACTN_CHANGE_CARD)):(a.showChooseCreditCardForm=!0,this.log(b("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_CHOOSE_CARD));this.setState(a)},onConfirmAmountCancel:function(){this.setState({confirmAmountDialogShown:!1})},onConfirmAmountSuccess:function(){this._isAmountVerified=!0,this.initiatePayment()},onVerifyCreditCardSuccess:function(){this.initiatePayment()},onVerifyCreditCardCancel:function(){this.setState({verifyCreditCardDialogShown:!1})},handleMemoTextChange:function(a){this.setState({memoText:a})},handleMemoPhotoChange:function(a){this.setState({memoPhotoIDs:a})},handleMemoPhotoUploadingChange:function(a){this.setState({isMemoPhotoUploading:a})},isSendButtonDisabled:function(){return!this.state.isAmountValid||!this.state.creditCards.length||this.state.loading||this.state.isMemoPhotoUploading||this.isGroupRequest()},isRequestButtonDisabled:function(){return!this.state.isAmountValid||this.state.loading},isAddCardNextButtonDisabled:function(){return!this.state.isAmountValid},renderAddDebitCardLink:function(){return b("React").createElement(b("P2PText.react"),{className:"_42h3",type:"secondary",ref:"send_money_dialog_add_card_text"},b("React").createElement(b("Link.react"),{className:"_49nm",href:"#",onClick:this.handleAddCreditCardClick},l))},renderSelectedCard:function(){var a=this.state.selectedCard;return b("React").createElement(b("P2PText.react"),{className:"_21x5",size:"small",type:"primary"},b("React").createElement("div",{className:"_49nn"},a.getName()),b("React").createElement("div",{className:"_21wx"},a.getCreditCardNumberFormatted()),b("React").createElement("div",{className:"_21ww"},"\xb7"),b("React").createElement(b("Link.react"),{className:"_21wy",onClick:this.handleChangeSelectedCardClick,href:"#"},k))},renderFormButtons:function(){var a,c=i&&this.props.useModal?b("React").createElement(b("P2PButton.react"),{label:h._("Cancel"),onClick:function(){this._handleToggle(!1)}.bind(this),type:"secondary"}):null;this.isRequesting()?a=b("React").createElement("div",null,c,this.renderRequestButton()):!this.state.creditCards.length?a=b("React").createElement("div",null,c,this.renderAddCardNextButton()):this.state.showChooseCreditCardForm?a=b("React").createElement("div",null,this.renderChooseCardBackButton(),this.renderChooseCardNextButton()):a=b("React").createElement("div",null,c,this.renderPayButton());return a},renderChooseCardBackButton:function(){return b("React").createElement(b("P2PButton.react"),{label:h._("Back"),onClick:this.handleBackClick,ref:"back_button",size:"medium",type:"secondary",use:"default"})},renderAddCardNextButton:function(){return b("React").createElement(b("P2PButton.react"),{disabled:this.isAddCardNextButtonDisabled(),label:h._("Next"),onClick:this.handleAddCardNextClick,ref:"add_card_next_button",size:"medium",type:"primary",use:"default"})},renderChooseCardNextButton:function(){return b("React").createElement(b("P2PButton.react"),{label:h._("Next"),onClick:this.handleChooseCardNextClick,ref:"choose_card_next_button",size:"medium",type:"primary",use:"confirm"})},renderPayButton:function(){return b("React").createElement(b("P2PButton.react"),{disabled:this.isSendButtonDisabled(),label:h._("Pay"),onClick:this.handleSendClick,ref:"send_button",size:"medium",type:"primary",use:"confirm"})},renderRequestButton:function(){return b("React").createElement(b("P2PButton.react"),{disabled:this.isRequestButtonDisabled(),label:h._("Request"),onClick:this.handleRequestClick,ref:"request_button",size:"medium",type:"primary",use:"confirm"})},renderPaymentDetails:function(){var a;if(this.isRequesting())return null;this.state.creditCards.length?this.state.showChooseCreditCardForm?a=this.renderAddDebitCardLink():a=this.renderSelectedCard():this.state.creditCardsFetchError?a=b("React").createElement("div",{className:"_2abl"},b("React").createElement(b("P2PText.react"),{type:"secondary",ref:"send_money_dialog_add_card_next_text"},h._("Sorry, we couldn't fetch your details. Please check your internet connection or refresh this page and try again."))):a=b("React").createElement("div",{className:"_2abl"},b("React").createElement(b("P2PText.react"),{type:"secondary",ref:"send_money_dialog_add_card_next_text"},h._("Sending money is free and secure")));return a},isRecipientIneligible:function(){var a=this.props.p2pEligibilities;if(!a||this.props.receivers.size===0)return!1;var b=this.props.receivers.find(function(b){return!a[b.userID]});return!!b},isDialogDisabled:function(){return!!(b("P2PGKValues").P2PDisabledReason||this.isRecipientIneligible())},renderDisabledText:function(){__p&&__p();if(!this.isDialogDisabled())return null;var a=b("P2PGKValues").P2PDisabledReason;if(a)return b("PaymentSettingsStringUtils").getP2PDisabledText(a);if(this.isRecipientIneligible()){a=this.props.receivers.get(0)||{};a=a.short_name||"";return h._("{receiverName} isn't able to receive money right now. {Learn more about p2p link}",[h._param("receiverName",a),h._param("Learn more about p2p link",b("React").createElement(b("Link.react"),{href:b("P2PLinkConstants").receiverIneligibleHelpURI,target:"_blank"},h._("Learn More.")))])}return b("PaymentSettingsStringUtils").getGeneralP2PDisabledText()},renderFooter:function(){var a;this.isDialogDisabled()?a=b("React").createElement(b("P2PText.react"),{className:"_2pi8",type:"secondary"},this.renderDisabledText()):!this.state.isCreditCardsFetchComplete?a=b("React").createElement("div",{className:"_2-vg"},b("React").createElement(b("XUISpinner.react"),{className:"_2-vh"})):a=[b("React").createElement("div",{className:"_21x4",key:"paymentDetails"},this.renderPaymentDetails()),b("React").createElement("div",{className:"_4zf-",key:"formButtons"},this.renderFormButtons())];return b("React").createElement("div",{className:"_5p-k"},a)},renderMemo:function(){var a=this.isPayingForRequest(),c=this.props.memoText||this.state.memoText;if(a&&!c)return null;return a&&c?b("React").createElement("div",{className:"_5exl"},b("React").createElement(b("P2PMemoText.react"),{memoText:c})):b("React").createElement("div",{className:"_5exl"},b("React").createElement(b("P2PMemoField.react"),{defaultValue:c,disabled:this.isDialogDisabled(),isRequesting:this.isRequesting(),onTextChange:this.handleMemoTextChange,onPhotoChange:this.handleMemoPhotoChange,onPhotoUploadingChange:this.handleMemoPhotoUploadingChange}))},renderSendMoneyForm:function(){return b("React").createElement("div",null,this.renderTitle(),b("React").createElement("div",{className:"_2abm"},this.renderMainContainer()),this.renderMemo(),b("React").createElement("div",{className:"_21w-"+(this.isDialogDisabled()?" _3orf":"")+(i?" _4eb_":"")},this.renderFooter()))},renderMainContainer:function(){var a,c=this.state.amount,d=this.isPayingForRequest(),e=this.props.p2pPaymentConfig,f=b("PECurrency").getCurrencyOffset(e.currencyCode)||1,g=e.maxTransferAmount/f;this.state.showChooseCreditCardForm?a=b("React").createElement("div",{className:"_xn7"},b("React").createElement(b("P2PChooseCreditCardForm.react"),{creditCards:this.state.creditCards,selectedCard:this.state.selectedCard,ref:"choose_credit_card_form"})):(!d?f=b("React").createElement(b("P2PSendMoneyAmountInput.react"),{amountOffset:f,currencySymbol:this.props.currencySymbol,disabled:this.isDialogDisabled(),allowDecimals:f===100,isRequesting:this.isRequesting(),maxAmount:g,onInputChange:this.onAmountInputChange,receiversCount:this.props.receivers.size,ref:"send_money_amount_input",value:c}):f=b("React").createElement(b("P2PBigAmount.react"),{amount:c,className:"_3oh-",currencyCode:e.currencyCode,size:"large"}),a=b("React").createElement("div",{className:"_2abn"+(d?" _74p":"")},f));return a},renderActionText:function(){return this.isRequesting()?h._("Send request to"):h._("Send to")},renderActionToggleHeader:function(){var a=this.isPaying(),c=this.isRequesting();return this.isPayingForRequest()||!j?null:b("React").createElement("div",{className:"_4uvi"},b("React").createElement(b("P2PSendMoneyDialogActionHeader.react"),{isPayTabDisabled:this.isGroupRequest()||!this.props.p2pPaymentConfig.enabledActions.send,isRequestTabDisabled:!this.props.p2pPaymentConfig.enabledActions.request,isPaying:a,isRequesting:c,onPayClick:function(){if(this.isPaying())return;this.setState({isPaying:!0,isRequesting:!1},function(){this.focusAmountInput(),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_SEND)}.bind(this))}.bind(this),onRequestClick:function(){this.isRequesting()||this.setState({isPaying:!1,isRequesting:!0},function(){this.focusAmountInput(),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_REQUEST)}.bind(this))}.bind(this)}))},renderLayers:function(){var a={},c=this.props.receivers.get(0)||{};c=c.short_name;var d,e,f;this.props.useModal&&(f={LayerFadeOnShow:!1});this.state.addCreditCardDialogShown?(this.state.isAmountValid&&(e=h._("Please enter a debit card to send {Amount} to {Recipient name}. Credit cards can't be used.",[h._param("Amount",this.props.currencySymbol+this.state.amount),h._param("Recipient name",c)]),d=h._("Pay")),a.addCreditCard=b("React").createElement(b("P2PAddCreditCardDialog.react"),{behaviors:f,eventFlow:this.getEventFlow(),loggingData:this.getPlatformLoggingData(),onCancel:this.onAddCreditCardCancel,onSuccess:this.onAddCreditCardSuccess,ref:"send_money_dialog_add_credit_card_form",saveButtonText:d,showCancelButton:!!i,text:e})):this.state.confirmAmountDialogShown?a.confirmAmount=b("React").createElement(b("P2PConfirmAmountDialog.react"),{amount:this.state.amount,behaviors:f,currencySymbol:this.props.currencySymbol,onCancel:this.onConfirmAmountCancel,onConfirm:this.onConfirmAmountSuccess,receiverName:c}):this.state.verifyCreditCardDialogShown?a.verifyCreditCard=b("React").createElement(b("P2PVerifyCreditCardDialog.react"),{asyncRequestState:this.state.asyncRequestState,behaviors:f,creditCard:this.state.selectedCard,isSending:!0,onCancel:this.onVerifyCreditCardCancel,onSuccess:this.onVerifyCreditCardSuccess}):this.state.editCreditCardDialogShown&&(a.confirmAmount=b("React").createElement(b("P2PEditCreditCardDialog.react"),{asyncRequestState:this.state.asyncRequestState,behaviors:f,creditCard:this.state.selectedCard,onCancel:this.onEditCreditCardCancel,onSuccess:this.onEditCreditCardSuccess}));return a},renderIneligibleMask:function(){return!this.isDialogDisabled()?null:b("React").createElement("div",{className:"_3org"})},renderReceiverImage:function(a){var c=i?32:40;return b("React").createElement(b("MessengerContactImage.react"),{key:a.userID,size:c,src:a.big_image_src||a.image_src})},renderSingleRecipient:function(){var a=i?32:40,c=this.props.receivers.get(0)||{};return b("React").createElement("div",{className:"_49no",ref:"send_money_dialog_title"},b("React").createElement(b("ImageBlock.react"),{spacing:"large"},b("React").createElement(b("Image.react"),{className:"_5p-i",height:a,src:c.big_image_src||c.image_src,width:a}),b("React").createElement("div",{className:"_3-8w"},b("React").createElement(b("P2PText.react"),{type:"secondary"},this.renderActionText()),b("React").createElement(b("P2PText.react"),{className:"_5p-j",size:"small",type:"primary",weight:"bold"},c.name))),b("React").createElement(b("Link.react"),{className:"_49np",href:b("P2PLinkConstants").helpCenterURI,target:"_blank","aria-label":h._("Help")}))},renderTitle:function(){if(this.props.receivers.size===1)return this.renderSingleRecipient();var a=i?32:40,c=12;return b("React").createElement("div",{className:"_49no",ref:"send_money_dialog_title"},b("React").createElement(b("MessengerHorizontalScroll.react"),{childPadding:8,childWidth:a,freeScroll:!0,width:this.getDialogWidth()-c*2},this.props.receivers.map(this.renderReceiverImage)))},render:function(){var a,c=null,d={};if(this.props.useModal&&this.isDialogShowing())return null;this.props.useModal?(a=b("P2PDialog.react"),c=b("React").createElement(b("P2PDialogTitle.react"),{className:"_30wi"},h._("Confirm Payment")),d={layerHideOnBlur:!1}):(a=i?b("MessengerContextualDialog.react"):b("XUIContextualDialog.react"),d={alignment:this.props.flyoutAlignment?this.props.flyoutAlignment:i?"right":"left",context:this.props.context,position:this.props.position||"above",onBlur:this._handleBlur});return b("React").createElement(a,babelHelpers["extends"]({onToggle:this._handleToggle,shown:!0,width:this.getDialogWidth()},d),b("React").createElement("div",{className:"_21x9"+(i?" _1pka":"")+(j?" _4uvl":"")+(this.props.useModal?" _35wt":"")},c,this.renderActionToggleHeader(),this.renderSendMoneyForm(),this.renderIneligibleMask(),b("React").createElement(b("P2PLoadingMask.react"),{ref:"send_money_dialog_loader",visible:this.state.loading})))}});e.exports=c}),null);
__d("P2PEncryptedText.react",["ix","cx","fbt","xuiglyph","Image.react","P2PText.react","React"],(function(a,b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);k=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=k.constructor).call.apply(a,[this].concat(d)),this.getEncryptedMessage=function(){return this.props.showPasswordProtected?i._("Encrypted and password protected."):i._("Encrypted and private.")}.bind(this),b}a.prototype.render=function(){return b("React").createElement(b("P2PText.react"),{type:"secondary"},b("React").createElement("div",{className:"__8t"},b("React").createElement(b("Image.react"),{src:g("89465")})),b("React").createElement("span",{className:"_2pir"},this.getEncryptedMessage()))};a.propTypes={showPasswordProtected:c.bool};a.defaultProps={showPasswordProtected:!1};e.exports=a}),null);
__d("P2PNUXNextButton.react",["fbt","P2PButton.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){return b("React").createElement(b("P2PButton.react"),{label:g._("Next"),onClick:this.props.onNextClick,use:"confirm"})};function a(){h.apply(this,arguments)}a.propTypes={onNextClick:c.func.isRequired};e.exports=a}),null);
__d("P2PNUXFooter.react",["cx","LeftRight.react","P2PEncryptedText.react","P2PNUXNextButton.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){return b("React").createElement(b("LeftRight.react"),null,b("React").createElement("div",{className:"_2pic"},b("React").createElement(b("P2PEncryptedText.react"),null)),b("React").createElement(b("P2PNUXNextButton.react"),{onNextClick:this.props.onNextClick}))};function a(){h.apply(this,arguments)}a.propTypes={onNextClick:c.func.isRequired};e.exports=a}),null);
__d("P2PSendMoneyNUXListItems.react",["fbt","ix","Image.react","P2PListRow.react","P2PText.react","React"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.renderRow=function(a,c){return b("React").createElement(b("P2PListRow.react"),{offset:this.props.size},b("React").createElement(b("Image.react"),a),b("React").createElement(b("P2PText.react"),{type:"primary"},c))}.bind(this),c}a.prototype.render=function(){var a=this.props.size;return b("React").createElement("div",null,this.renderRow(a==="small"?{height:18,src:h("94401"),width:18}:{height:36,src:h("94400"),width:36},g._("It's FREE to send and receive money.")),this.renderRow(a==="small"?{height:27,src:h("94405"),width:18}:{height:54,src:h("94404"),width:36},g._("Industry-leading security \u2014 password protection, anti-fraud team and more.")),this.renderRow(a==="small"?{height:13,src:h("94403"),width:18}:{height:26,src:h("94402"),width:36},g._("Send money from your debit card to theirs.")))};a.propTypes={offset:c.oneOf(["small","medium"])};a.defaultProps={size:"small"};e.exports=a}),null);
__d("P2PSendMoneyNUXTitleText.react",["fbt","React"],(function(a,b,c,d,e,f,g){"use strict";function a(){return b("React").createElement("div",null,g._("Send Money to Anyone"))}e.exports=a}),null);
__d("P2PSendMoneyNUXTitle.react",["cx","fbt","P2PSendMoneyNUXTitleText.react","P2PText.react","React"],(function(a,b,c,d,e,f,g,h){"use strict";var i;i=babelHelpers.inherits(a,b("React").Component);i&&i.prototype;a.prototype.render=function(){return b("React").createElement("div",{className:"_4fz1"},b("React").createElement(b("P2PText.react"),{size:"medium",type:"primary"},b("React").createElement(b("P2PSendMoneyNUXTitleText.react"),null)),b("React").createElement(b("P2PText.react"),{type:"secondary"},h._("Split dinner, pay rent or anything else")))};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("P2PSendMoneyNUXContextualDialog.react",["cx","MessengerContextualDialog.react","MessengerEnvironment","P2PLogger","P2PNUXFooter.react","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PSendMoneyNUXListItems.react","P2PSendMoneyNUXTitle.react","React","XUIContextualDialog.react"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.log=function(a,c){b("P2PLogger").log(a,babelHelpers["extends"]({www_event_flow:b("P2PPaymentLoggerEventFlow").UI_FLOW_P2P_SEND},this.props.loggingData,c))}.bind(this),this.handleNextClick=function(){this.log(b("P2PPaymentLoggerEvent").UI_ACTN_SEND_MONEY_NUX_NEXT_CLICK),this.props.onNextClick()}.bind(this),this.$1=function(a){this.props.onToggle(a)}.bind(this),c}a.prototype.componentDidMount=function(){this.log(b("P2PPaymentLoggerEvent").UI_ACTN_SEND_MONEY_NUX_SHOWN)};a.prototype.render=function(){var a=b("MessengerEnvironment").messengerui?b("MessengerContextualDialog.react"):b("XUIContextualDialog.react");return b("React").createElement(a,{alignment:this.props.flyoutAlignment,context:this.props.context,contextRef:this.props.contextRef,onBlur:function(){return this.$1(!1)}.bind(this),onToggle:this.$1,position:this.props.position,shown:!0,width:this.props.width},b("React").createElement("div",{className:"_56i7"},b("React").createElement("div",{className:"_56jc"},b("React").createElement(b("P2PSendMoneyNUXTitle.react"),null)),b("React").createElement("div",{className:"_56jd"},b("React").createElement(b("P2PSendMoneyNUXListItems.react"),null)),b("React").createElement(b("P2PNUXFooter.react"),{onNextClick:this.handleNextClick})))};a.propTypes={loggingData:c.object,onNextClick:c.func.isRequired,onToggle:c.func.isRequired,width:c.number};a.defaultProps=function(){var a=b("MessengerEnvironment").messengerui;return{flyoutAlignment:a?"right":"left",position:"above",width:a?286:260}}();e.exports=a}),null);
__d("P2PSendMoneySuccessDialog.react",["fbt","Link.react","P2PLinkConstants","P2PSuccessDialog.react","P2PText.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){return b("React").createElement(b("P2PSuccessDialog.react"),{onOKClick:this.props.onClose,title:g._("Payment Sent")},b("React").createElement(b("P2PText.react"),{type:"primary"},g._("When you receive money, it will go on this card too. You can update your card in {Link with text that goes to settings page}.",[g._param("Link with text that goes to settings page",b("React").createElement(b("Link.react"),{target:"_blank",href:b("P2PLinkConstants").settingsWWWURI},g._("Payments Settings")))])))};function a(){h.apply(this,arguments)}a.propTypes={onClose:c.func.isRequired};e.exports=a}),null);
__d("P2PTransferRiskResult",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({SUCCESS:"SUCCESS",UNDER_MANUAL_REVIEW:"UNDER_MANUAL_REVIEW",REQUIRE_VERIFICATION:"REQUIRE_VERIFICATION"})}),null);
__d("P2PTransferStore",["Arbiter","ChannelConstants","CreditCardFormParam","CurrentUser","EventEmitter","ImmutableObject","P2PActionConstants","P2PActions","P2PAPI","P2PChannelType","P2PCreditCard","P2PDispatcher","P2PGKValues","P2PNUXRendererUtils","P2PTransferParam","P2PTransferStatus","MercuryThreadInformer"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("MercuryThreadInformer").get(),i=!1,j,k=[],l,m={},n=!1,o=!1,p=new Set(),q=!1,r=0;function s(a,c){c&&(m[c]=new(b("ImmutableObject"))(a))}function t(a,b){b&&(m[b]={error:a})}c=babelHelpers.inherits(a,b("EventEmitter"));g=c&&c.prototype;function a(){g.constructor.call(this),b("Arbiter").subscribe(b("ChannelConstants").getArbiterType(b("P2PChannelType").TRANSFER_STATUS_CHANGED),this.handleChannelTransferStatusChanged.bind(this)),h.subscribe("messages-received",this.handleMessageReceived.bind(this)),b("P2PDispatcher").register(this.onEventDispatched.bind(this))}a.prototype.onEventDispatched=function(a){__p&&__p();var c=a.data;a=a.type;switch(a){case b("P2PActionConstants").TRANSFERS_UPDATED:this.handleTransfersUpdated(c);this.emit("change");break;case b("P2PActionConstants").TRANSFERS_UPDATED_ERROR:this.handleTransfersUpdatedError(c);this.emit("change");break;case b("P2PActionConstants").NUX_TRANSFERS_UPDATED:this.handleNUXTransfersUpdated(c);this.emit("change");break;case b("P2PActionConstants").TRANSFER_ADDED:this.handleTransferAdded(c);this.emit("change");break;case b("P2PActionConstants").TRANSFER_UPDATED:this.handleTransferUpdated(c);this.emit("change");break;case b("P2PActionConstants").TRANSFER_ACCEPTED:this.handleTransferAccepted();this.emit("change");break;case b("P2PActionConstants").TRANSFER_DECLINED:this.handleTransferDeclined(c);this.emit("change");break;case b("P2PActionConstants").EXTENSIVE_TRANSFER_DETAILS_UPDATED:this.handleTransferWithExtensiveDetails(c);this.emit("change");break}};a.prototype.getAsyncRequestState=function(){return m};a.prototype.handleTransfersUpdated=function(a){__p&&__p();l=null;n=!0;var c=[];a=a.map(function(a){var d={},e=this.getTransferByID(a[b("P2PTransferParam").TRANSFER_ID]),f={};a.creditCard&&(d[b("CreditCardFormParam").CREDENTIAL_ID]=a.creditCard[b("CreditCardFormParam").CREDENTIAL_ID],d[b("CreditCardFormParam").CARD_NUMBER]=a.creditCard[b("CreditCardFormParam").CARD_NUMBER],d[b("CreditCardFormParam").CARD_TYPE]=a.creditCard[b("CreditCardFormParam").CARD_TYPE],a.creditCard=new(b("P2PCreditCard"))(d));if(e)for(var g in e)f[g]=a[g]!==null?a[g]:e[g];c.push(a[b("P2PTransferParam").TRANSFER_ID]);return new(b("ImmutableObject"))(a,f)}.bind(this));var d=k.filter(function(a){return c.indexOf(a[b("P2PTransferParam").TRANSFER_ID])===-1});k=a.concat(d);k=k.sort(function(a,b){return b.creationTime-a.creationTime})};a.prototype.handleTransfersUpdatedError=function(a){l=a.error,t(a.requestID,a.error)};a.prototype.handleNUXTransfersUpdated=function(a){n||this.handleTransfersUpdated(a)};a.prototype.handleTransferAdded=function(a){__p&&__p();var c;s(a,a.requestID);a&&a.sender&&a.sender.id===b("CurrentUser").getID()&&(q=!0);c=k.filter(function(c){return c[b("P2PTransferParam").TRANSFER_ID]===a[b("P2PTransferParam").TRANSFER_ID]})[0];if(c)return;k.push(new(b("ImmutableObject"))(a));k=k.sort(function(a,b){return b.creationTime-a.creationTime})};a.prototype.handleTransferAddedError=function(a){t(a.requestID,a.errors)};a.prototype.handleChannelTransferStatusChanged=function(a,c){c=c.obj,b("P2PActions").transferUpdated(c)};a.prototype.handleMessageReceived=function(a,c){__p&&__p();for(var d in c)if(Object.prototype.hasOwnProperty.call(c,d)){a=c[d];for(var e=0;e<a.length;e++)if(a[e].attachments&&a[e].attachments.length){var f=b("P2PNUXRendererUtils").getTransferFromMessage(a[e]);if(f){!this.hasReceived()&&f.receiver.id===b("CurrentUser").getID()&&b("P2PAPI").getBannerStates();b("P2PActions").transferAdded(f);return}}}};a.prototype.handleTransferUpdated=function(a){for(var c=0,d=k.length;c<d;c++)k[c][b("P2PTransferParam").TRANSFER_ID]===a[b("P2PTransferParam").TRANSFER_ID]&&(k[c]=b("ImmutableObject").set(k[c],a))};a.prototype.handleTransferAccepted=function(){var a;for(var c=0,d=k.length;c<d;c++)k[c][b("P2PTransferParam").STATUS]===b("P2PTransferStatus").PENDING_RECIPIENT_NUX&&(a={},a[b("P2PTransferParam").STATUS]=b("P2PTransferStatus").COMPLETED,k[c]=b("ImmutableObject").set(k[c],a));o=!0};a.prototype.handleTransferDeclined=function(a){var c;for(var d=0,e=k.length;d<e;d++)if(k[d][b("P2PTransferParam").TRANSFER_ID]===a[b("P2PTransferParam").TRANSFER_ID]&&k[d][b("P2PTransferParam").STATUS]===b("P2PTransferStatus").PENDING_RECIPIENT_NUX){c={};c[b("P2PTransferParam").STATUS]=b("P2PTransferStatus").CANCELED_DECLINED;k[d]=b("ImmutableObject").set(k[d],c);break}};a.prototype.handleTransferUpdatedError=function(a){t(a.requestID,a.errors)};a.prototype.getTransferByID=function(a){return k.filter(function(c){return a===c[b("P2PTransferParam").TRANSFER_ID]})[0]};a.prototype.getAll=function(a){i||(i=!0,b("P2PAPI").getTransactions(a));return k};a.prototype.getNUXTransfer=function(){var a=k.filter(function(a){return b("P2PNUXRendererUtils").isRecipientActionableStatus(a)})[0];!a&&!j&&!i&&(j=!0,b("P2PAPI").getNUXTransactions());a&&!a.currency&&r++<3&&b("P2PAPI").getNUXTransactions();return a};a.prototype.hasTransfers=function(){return k.length>0};a.prototype.hasAccepted=function(){return o};a.prototype.hasReceivedFromSender=function(a){for(var b=0,c=k.length;b<c;b++)if(k[b].sender.id===a)return!0;return!1};a.prototype.hasReceived=function(){for(var a=0,c=k.length;a<c;a++)if(k[a].receiver.id===b("CurrentUser").getID())return!0;return!1};a.prototype.getTransferFetchError=function(){return l};a.prototype.getTransferWithExtensiveDetailsByID=function(a){p.has(a)||(p.add(a),b("P2PAPI").getExtensiveTransferDetailsByID(a))};a.prototype.handleTransferWithExtensiveDetails=function(a){this.getTransferByID(a.transfer_id)?this.handleTransferUpdated(a):this.handleTransferAdded(a)};a.prototype.getAllLocal=function(){return k};a.prototype.hasSentDuringSession=function(){return q};a.prototype.shouldShowSenderNUX=function(){return!b("P2PGKValues").P2PUserAddedCredentialBefore&&!this.hasSentDuringSession()};e.exports=new a()}),null);
__d("P2PUnderManualReviewDialog.react",["fbt","P2PButton.react","P2PDialog.react","P2PDialogBody.react","P2PDialogFooter.react","P2PDialogTitle.react","P2PText.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){return b("React").createElement(b("P2PDialog.react"),{layerHideOnBlur:!1,shown:!0,width:300},b("React").createElement(b("P2PDialogTitle.react"),{showCloseButton:!1},g._("Reviewing Payment Info")),b("React").createElement(b("P2PDialogBody.react"),null,b("React").createElement(b("P2PText.react"),{type:"primary"},g._("For your security, this payment is in review for up to 24 hours. When it's confirmed, it will go through."))),b("React").createElement(b("P2PDialogFooter.react"),null,b("React").createElement(b("P2PButton.react"),{label:g._("OK"),onClick:this.props.onClose,use:"confirm"})))};function a(){h.apply(this,arguments)}a.propTypes={onClose:c.func.isRequired};e.exports=a}),null);
__d("P2PUserEligibilityContainer.react",["P2PUserEligibilityStore","React","StoreAndPropBasedStateMixin","immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=b("React").PropTypes;c=b("React").createClass({displayName:"P2PUserEligibilityContainer",propTypes:{participants:a.instanceOf(b("immutable").List)},mixins:[b("StoreAndPropBasedStateMixin")(b("P2PUserEligibilityStore"))],statics:{calculateState:function(a){a=a.participants;var c;a&&(a=a.map(function(a){return a.userID}).toArray(),c=b("P2PUserEligibilityStore").getEligibilityByUserIDs(a));return{p2pEligibilities:c}}},render:function(){var a=b("React").Children.only(this.props.children);return b("React").cloneElement(a,{p2pEligibilities:this.state.p2pEligibilities})}});e.exports=c}),null);
__d("P2PVerificationFlowHelper",["AsyncDialog","AsyncRequest","P2PAPI","P2PTransferParam","emptyFunction"],(function(a,b,c,d,e,f){__p&&__p();var g=null,h=null,i=null;a={startVerificationFlow:function(a,c,d){g=a,h=c,i=d||b("emptyFunction"),b("AsyncDialog").send(new(b("AsyncRequest"))("/p2p/verify/dialog/?id="+a))},setupFlowExitHandler:function(a,c,d,e){__p&&__p();var f=function(b){i(b),g=null,h=null,i=null,a.destroy(),c.destroy()};if(d)a.subscribe("hide",function(){f(e)});else{var j=!1,k=!1;a.subscribe("confirm",function(){j=!0});a.subscribe("hide",function(){j?(a.destroy(),c.destroy()):h?c.show():f(!1)});c.subscribe("confirm",function(){k=!0;var a={};a[b("P2PTransferParam").TRANSFER_ID]=g;b("P2PAPI").cancelTransaction({formData:a});f(!1)});c.subscribe("hide",function(){k||a.show()})}}};e.exports=a}),null);
__d("PaymentStepType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({NUX_INTRO:"NUX_INTRO",IDV:"IDV",CREATE_PIN:"CREATE_PIN",ENTER_AMOUNT:"ENTER_AMOUNT",ADD_PAYMENT_METHOD:"ADD_PAYMENT_METHOD",AUTH:"AUTH",SETUP_COMPLETE:"SETUP_COMPLETE",RECEIPT:"RECEIPT",FORM:"FORM",IDV_PENDING:"IDV_PENDING",DECISION:"DECISION",PSD_AGREEMENT:"PSD_AGREEMENT",PICKER:"PICKER"})}),null);
__d("PeerToPeerFlowOrigin",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({SEND:"SEND",RECEIVE_BUBBLE:"RECEIVE_BUBBLE",RECEIVE_NOTIFICATION:"RECEIVE_NOTIFICATION",REQUESTEE_SEND:"REQUESTEE_SEND"})}),null);
__d("P2PSendMoneyButton.react",["fbt","AllPaymentTypeFields","FBPaymentsVerificationFlowContainer.react","MessengerEnvironment","P2PAbstractSendMoneyButton.react","P2PActions","P2PErrorDialog.react","P2PGKValues","P2PGroupSendDialog.react","P2PGroupSendParticipantsPickerDialog.react","P2PLogger","P2PPasswordProtectionNUXDialog.react","P2PPasswordProtectionStatusTypes","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PPaymentPhasesQueryWebGraphQLQuery","P2PPaymentSupportedCountry","P2PSendMoneyDialog.react","P2PSendMoneyNUXContextualDialog.react","P2PSendMoneySuccessDialog.react","P2PTransferParam","P2PTransferRiskResult","P2PTransferStore","P2PUnderManualReviewDialog.react","P2PUserEligibilityContainer.react","P2PVerificationFlowHelper","PaymentStepType","PECurrency","PeerToPeerFlowOrigin","React","ReactDOM","ReactLayeredComponentMixin_DEPRECATED","UserVerificationProductType","WebGraphQL","emptyFunction","immutable","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=b("React").PropTypes;c=b("React").createClass({displayName:"P2PSendMoneyButton",mixins:[b("ReactLayeredComponentMixin_DEPRECATED")],propTypes:{amount:a.string,button:a.object,fromChatTab:a.bool,groupSendRecipientUserIDs:a.arrayOf(a.string),groupThreadFBID:a.string,flyoutAlignment:a.string,openRequestTab:a.bool,isNewEmptyLocalThread:a.bool,isGroupChat:a.bool,onCompletion:a.func,onTrigger:a.func,p2pPaymentConfig:a.shape({currencyCode:a.string.isRequired,enabledActions:a.object.isRequired,enabledPaymentMethods:a.object.isRequired,maxTransferAmount:a.number.isRequired,title:a.string,use_payment_module_method_picker:a.bool,countryCode:a.string.isRequired,postalRegex:a.string.isRequired}),participants:a.instanceOf(b("immutable").List),platformData:a.object,sendMoneyDialogShown:a.bool,threadID:a.string,threadFBID:a.string},getDefaultProps:function(){return{amount:"",groupThreadFBID:"",openRequestTab:!1,onTrigger:b("emptyFunction"),sendMoneyDialogShown:!1}},getInitialState:function(){return{sendMoneyNUXDismissed:!1,passedIDVerification:!1}},log:function(a,c){b("P2PLogger").log(a,babelHelpers["extends"]({www_event_flow:b("P2PPaymentLoggerEventFlow").UI_FLOW_P2P_SEND},c))},canShowSendMoneyDialog:function(){return!!(this.props.participants&&this.props.participants.size)},originalCreateTransactionResponse:null,_onButtonClick:function(){var a=this.getRecipients();this.log(b("P2PPaymentLoggerEvent").UI_ACTN_SEND_MONEY_BUTTON_CLICKED,this.getLogData(a));this.canShowSendMoneyDialog()&&this.showSendMoneyDialog()},showIDVerificationDialog:function(){b("P2PActions").showDialog(b("FBPaymentsVerificationFlowContainer.react"),{onClose:b("P2PActions").hideDialog,paymentType:b("AllPaymentTypeFields").MOR_P2P_TRANSFER,verificationProductType:b("UserVerificationProductType").P2P})},hideSendMoneyDialog:function(){b("P2PActions").chatSendViewClosed({threadID:this.props.threadID})},showSendMoneyDialog:function(){b("P2PActions").chatSendViewOpened({referrer:this.props.referrer,threadID:this.props.threadID,fromChatTab:this.props.fromChatTab})},_handleDialogToggle:function(a){!a?this.hideSendMoneyDialog():this.showSendMoneyDialog()},handlePaymentRequestSuccess:function(){this.hideSendMoneyDialog(),this.props.onTrigger(),this.props.onCompletion&&this.props.onCompletion()},handleOnSendSuccess:function(a){this.hideSendMoneyDialog();var c=a[b("P2PTransferParam").RISK_RESULT];this.originalCreateTransactionResponse=a;c===b("P2PTransferRiskResult").REQUIRE_VERIFICATION?b("P2PVerificationFlowHelper").startVerificationFlow(a.id,!0,this.handleVerificationCompleted):c===b("P2PTransferRiskResult").UNDER_MANUAL_REVIEW?this.showUnderManualReviewDialog():this.handlePostSendSteps(!1)},handleVerificationCompleted:function(a){this.handlePostSendSteps(!a)},handlePostSendSteps:function(a){var c=this.originalCreateTransactionResponse,d=c.passwordProtection===b("P2PPasswordProtectionStatusTypes").NOT_SET;!a&&c.isFirstSend?(this._passwordNUXPending=d,this.showSendSuccessDialog()):d?this.showPasswordProtectionDialog():b("P2PActions").hideDialog();this.originalCreateTransactionResponse=null;this.props.onTrigger();this.props.onCompletion&&this.props.onCompletion()},handleConfirmationOKClick:function(){this._passwordNUXPending?(this._passwordNUXPending=!1,this.showPasswordProtectionDialog()):b("P2PActions").hideDialog()},handleSendError:function(a){this.showErrorDialog(a)},handlePaymentRequestError:function(a){this.showPaymentRequestErrorDialog(a)},getGroupSendDialog:function(){return b("P2PGKValues").P2PGroupRequestEnabled?b("P2PGroupSendParticipantsPickerDialog.react"):b("P2PGroupSendDialog.react")},getLogData:function(a){if(a.size>1)return{object_ids:a.map(function(a){return a.userID}).join(",")};a=a.get(0);return{object_id:a&&a.userID}},getMoneyButtonNode:function(){return b("ReactDOM").findDOMNode(this.refs.p2pSendMoneyButton)},getRecipients:function(){if(!this.props.participants)return b("immutable").List();if(!this.props.isGroupChat)return this.props.participants.slice(0,1);var a=this.props.groupSendRecipientUserIDs||[],c=a.reduce(function(a,b){a[b]=!0;return a},{});return this.props.participants.filter(function(a){return!!c[a.userID]})},setGroupSendDialog:function(a,c){var d=this.getGroupSendDialog();a.groupSendMoneyDialog=b("React").createElement(b("P2PUserEligibilityContainer.react"),{participants:this.props.participants},b("React").createElement(d,{amount:this.props.amount,context:this.getMoneyButtonNode(),flyoutAlignment:this.props.flyoutAlignment,fromChatTab:this.props.fromChatTab,openRequestTab:this.props.openRequestTab,currency:c,onToggle:this._handleDialogToggle,participants:this.props.participants,referrer:this.props.referrer,threadID:this.props.threadID,threadFBID:this.props.threadFBID}))},getGroupSendRecipient:function(){return this.props.participants&&this.props.participants.find(function(a){return a.userID===this.props.groupSendRecipientUserID}.bind(this))},showErrorDialog:function(a){var c=g._("Problem Sending Money");b("P2PActions").showDialog(b("P2PErrorDialog.react"),{error:a,onOKClick:b("P2PActions").hideDialog,title:c})},showPaymentRequestErrorDialog:function(a){var c=g._("Problem Requesting Money");b("P2PActions").showDialog(b("P2PErrorDialog.react"),{error:a,onOKClick:b("P2PActions").hideDialog,title:c})},showPasswordProtectionDialog:function(){b("P2PActions").showDialog(b("P2PPasswordProtectionNUXDialog.react"),{onComplete:b("P2PActions").hideDialog})},showSendSuccessDialog:function(){b("P2PActions").showDialog(b("P2PSendMoneySuccessDialog.react"),{onClose:this.handleConfirmationOKClick})},showUnderManualReviewDialog:function(){b("P2PActions").showDialog(b("P2PUnderManualReviewDialog.react"),{onClose:this.handlePostSendSteps.bind(this,!1)})},shouldShowNUX:function(){return!this.props.sendMoneyNUXDismissed&&!this.state.sendMoneyNUXDismissed&&b("P2PTransferStore").shouldShowSenderNUX()},shouldShowIDVerification:function(a){__p&&__p();a=(a=a)!=null?(a=a.viewer)!=null?(a=a.peer_to_peer_payments)!=null?a.peer_to_peer_payment_phases:a:a:a;if(a){a=a.some(function(a){a=a.steps||[];return a.map(function(a){return a.step_type}).includes(b("PaymentStepType").IDV)});a||this.setState({passedIDVerification:!0});return a}return!1},handleIDVerification:function(a){var c;this.state.passedIDVerification&&a();c=(c=this.props.p2pPaymentConfig)!=null?c.countryCode:c;c===b("P2PPaymentSupportedCountry").GB||c===b("P2PPaymentSupportedCountry").FR?b("promiseDone")(b("WebGraphQL").exec(new(b("P2PPaymentPhasesQueryWebGraphQLQuery"))({origin:b("PeerToPeerFlowOrigin").SEND})),function(b){this.shouldShowIDVerification(b)?(this.hideSendMoneyDialog(),this.showIDVerificationDialog()):a()}.bind(this)):a()},renderLayers:function(){if(!this.props.p2pPaymentConfig)return null;var a={},c=this.getRecipients();this.canShowSendMoneyDialog()&&this.props.sendMoneyDialogShown&&(this.shouldShowNUX()?a.nux=b("React").createElement(b("P2PSendMoneyNUXContextualDialog.react"),{context:this.getMoneyButtonNode(),loggingData:this.getLogData(c),flyoutAlignment:this.props.flyoutAlignment,onNextClick:function(){return this.handleIDVerification(function(){return this.setState({sendMoneyNUXDismissed:!0})}.bind(this))}.bind(this),onToggle:this._handleDialogToggle}):this.handleIDVerification(function(){return this.setSendDialog(a)}.bind(this)));return a},setSendDialog:function(a){var c=this.getRecipients(),d=this.props.p2pPaymentConfig.currencyCode;if(!c.size&&!this.props.groupSendRecipientUserID&&this.props.isGroupChat&&this.props.threadFBID)this.setGroupSendDialog(a,d);else{var e=b("PECurrency").getCurrencySymbol(d)||"$";a.sendMoneyDialog=b("React").createElement(b("P2PUserEligibilityContainer.react"),{participants:this.props.participants,ref:"send_money_dialog"},b("React").createElement(b("P2PSendMoneyDialog.react"),{amount:this.props.amount,context:this.getMoneyButtonNode(),currency:d,currencySymbol:e,groupThreadFBID:this.props.groupThreadFBID,flyoutAlignment:this.props.flyoutAlignment,openRequestTab:this.props.openRequestTab,memoText:this.props.memoText,onToggle:this._handleDialogToggle,onError:this.handleSendError,onPaymentRequestError:this.handlePaymentRequestError,onPaymentRequestSuccess:this.handlePaymentRequestSuccess,onSendSuccess:this.handleOnSendSuccess,p2pPaymentConfig:this.props.p2pPaymentConfig,platformData:this.props.platformData,receivers:c,ref:"send_money_dialog",referrer:this.props.referrer,paymentRequestID:this.props.paymentRequestID,useModal:this.props.useModal}))}},render:function(){if(this.props.isNewEmptyLocalThread&&this.props.participants.size>1)return null;return!this.props.p2pPaymentConfig?null:b("React").createElement(b("P2PAbstractSendMoneyButton.react"),{button:this.props.button,className:this.props.className,isActive:this.canShowSendMoneyDialog()&&this.props.sendMoneyDialogShown,isMessenger:!!b("MessengerEnvironment").messengerui,onClick:this._onButtonClick,ref:"p2pSendMoneyButton"})}});e.exports=c}),null);
__d("P2PSendMoneyContainer.react",["invariant","CurrentUser","ImmutableObject","MercuryIDs","MercuryShareAttachmentRenderLocations","MercuryThreadInfo","MessengerParticipants.bs","P2PSendMoneyButton.react","P2PSendMoneyDialogStore","React","StoreAndPropBasedStateMixin","immutable"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=b("React").PropTypes;c=b("React").createClass({displayName:"P2PSendMoneyContainer",propTypes:{button:a.node,className:a.string,flyoutAlignment:a.string,fromChatTab:a.bool,p2pPaymentConfig:a.object,participantIDs:a.array,onCompletion:a.func,onTrigger:a.func,thread:a.object,threadID:a.string},getDefaultProps:function(){return{referrer:b("MercuryShareAttachmentRenderLocations").CHAT}},mixins:[b("StoreAndPropBasedStateMixin")(b("P2PSendMoneyDialogStore"))],statics:{calculateState:function(a){__p&&__p();var c=a.threadID,d=a.thread,e=a.participantIDs,f=null,h=null,i,j;a=a.referrer;if(!c)return{};d&&(d.thread_id===c||g(0,4862));i=b("P2PSendMoneyDialogStore").getStateByThreadID(c);j=i&&i.referrer;c&&(!e&&d&&d.participants&&(e=d.participants.filter(function(a){return b("CurrentUser").getID()!==b("MercuryIDs").getUserIDFromParticipantID(a)})),e&&(f=b("immutable").List(),f=f.withMutations(function(a){e&&e.forEach(function(c){var d=b("MessengerParticipants.bs").getNow(c);c=b("MercuryIDs").getUserIDFromParticipantID(c);d=d&&b("ImmutableObject").set(d,{userID:c});d&&a.push(d)})})));h=d?b("MercuryThreadInfo").isNewEmptyLocalThread(d):!1;return babelHelpers["extends"]({},i,{participants:f,isNewEmptyLocalThread:h,isGroupChat:b("MercuryIDs").isGroupChat(c)&&!h,threadID:c,threadFBID:d&&d.thread_fbid,referrer:j||a})}},render:function(){return b("React").createElement(b("P2PSendMoneyButton.react"),babelHelpers["extends"]({},this.state,{button:this.props.button,className:this.props.className,flyoutAlignment:this.props.flyoutAlignment,fromChatTab:this.props.fromChatTab,onTrigger:this.props.onTrigger,p2pPaymentConfig:this.props.p2pPaymentConfig}))}});e.exports=c}),null);